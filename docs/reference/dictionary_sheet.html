<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Dictionary: define linelist tables and their variables – OutbreakTools documentation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../reference/exports_sheet.html" rel="next">
<link href="../reference/custom_formulas.html" rel="prev">
<link href="../images/icon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/icon.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">OutbreakTools documentation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../about.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-getting-started" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Getting started</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-getting-started">    
        <li>
    <a class="dropdown-item" href="../getting_started/download.html">
 <span class="dropdown-text">Download and prepare the tools</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../getting_started/workflow.html">
 <span class="dropdown-text">General workflow</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../getting_started/create_dic.html">
 <span class="dropdown-text">Fill the setup file</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../getting_started/compile.html">
 <span class="dropdown-text">Compile a linelist</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-setup-file-reference" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Setup file reference</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-setup-file-reference">    
        <li>
    <a class="dropdown-item" href="../reference/dictionary_sheet.html">
 <span class="dropdown-text">Dictionary sheet</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/choices_sheet.html">
 <span class="dropdown-text">Choice sheet</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/analyses_sheet.html">
 <span class="dropdown-text">Analyses sheet</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/exports_sheet.html">
 <span class="dropdown-text">Export sheet</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/translations_sheet.html">
 <span class="dropdown-text">Translation sheet</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">Tutoriels</span>
    </span>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-how-to" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">How to</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-how-to">    
        <li>
    <a class="dropdown-item" href="../how_to/export_subset_geo.html">
 <span class="dropdown-text">Export subset of geo columns</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how_to/link_tables.html">
 <span class="dropdown-text">Create two data entry tables</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/epicentre-msf/outbreak-tools" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../reference/analyses_sheet.html">Reference</a></li><li class="breadcrumb-item"><a href="../reference/dictionary_sheet.html">Dictionary: define linelist tables and their variables</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Options.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tables Management</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../getting_started/compile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compile a linelist</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../getting_started/create_dic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Create dictionary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../getting_started/download.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Obtain OutbreakTools files</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../getting_started/workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General workflow and files</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">How To</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../how_to/export_subset_geo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Export a subset of geographic columns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../how_to/link_tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Create linelists with more than one entry sheet</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Reference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/analyses_sheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Define basic analyses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/choices_sheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Define variable categories</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/custom_formulas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom formulas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/dictionary_sheet.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Dictionary: define linelist tables and their variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/exports_sheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Define exports</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/setup_file.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup reference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/translations_sheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generate linelist in several languages</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#variable-names-and-labels" id="toc-variable-names-and-labels" class="nav-link active" data-scroll-target="#variable-names-and-labels">Variable names and labels</a>
  <ul class="collapse">
  <li><a href="#variable-name" id="toc-variable-name" class="nav-link" data-scroll-target="#variable-name">Variable Name</a></li>
  <li><a href="#main-label" id="toc-main-label" class="nav-link" data-scroll-target="#main-label">Main Label</a></li>
  <li><a href="#dev-comment" id="toc-dev-comment" class="nav-link" data-scroll-target="#dev-comment">Dev Comment</a></li>
  <li><a href="#editable-label" id="toc-editable-label" class="nav-link" data-scroll-target="#editable-label">Editable Label</a></li>
  <li><a href="#sub-label" id="toc-sub-label" class="nav-link" data-scroll-target="#sub-label">Sub Label</a></li>
  <li><a href="#note" id="toc-note" class="nav-link" data-scroll-target="#note">Note</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  <li><a href="#sheets-and-sections" id="toc-sheets-and-sections" class="nav-link" data-scroll-target="#sheets-and-sections">Sheets and sections</a>
  <ul class="collapse">
  <li><a href="#sheet-name" id="toc-sheet-name" class="nav-link" data-scroll-target="#sheet-name">Sheet Name</a></li>
  <li><a href="#sheet-types" id="toc-sheet-types" class="nav-link" data-scroll-target="#sheet-types">Sheet Type</a></li>
  <li><a href="#main-section" id="toc-main-section" class="nav-link" data-scroll-target="#main-section">Main Section</a></li>
  <li><a href="#sub-section" id="toc-sub-section" class="nav-link" data-scroll-target="#sub-section">Sub Section</a></li>
  <li><a href="#sheet-sections-example" id="toc-sheet-sections-example" class="nav-link" data-scroll-target="#sheet-sections-example">Example</a></li>
  </ul></li>
  <li><a href="#properties" id="toc-properties" class="nav-link" data-scroll-target="#properties">Properties</a>
  <ul class="collapse">
  <li><a href="#status" id="toc-status" class="nav-link" data-scroll-target="#status">Status</a></li>
  <li><a href="#register-book" id="toc-register-book" class="nav-link" data-scroll-target="#register-book">Register Book</a></li>
  <li><a href="#personal-identifier" id="toc-personal-identifier" class="nav-link" data-scroll-target="#personal-identifier">Personal Identifier</a></li>
  <li><a href="#thinking-about-variables" id="toc-thinking-about-variables" class="nav-link" data-scroll-target="#thinking-about-variables">Thinking about variables</a></li>
  <li><a href="#var-type" id="toc-var-type" class="nav-link" data-scroll-target="#var-type">Variable Type</a></li>
  <li><a href="#var-format" id="toc-var-format" class="nav-link" data-scroll-target="#var-format">Variable Format</a></li>
  <li><a href="#var-control" id="toc-var-control" class="nav-link" data-scroll-target="#var-control">Control</a></li>
  <li><a href="#var-control-details" id="toc-var-control-details" class="nav-link" data-scroll-target="#var-control-details">Control details</a></li>
  <li><a href="#unique" id="toc-unique" class="nav-link" data-scroll-target="#unique">Unique</a></li>
  </ul></li>
  <li><a href="#data-exports" id="toc-data-exports" class="nav-link" data-scroll-target="#data-exports">Data exports</a></li>
  <li><a href="#data-validation" id="toc-data-validation" class="nav-link" data-scroll-target="#data-validation">Data validation</a>
  <ul class="collapse">
  <li><a href="#min" id="toc-min" class="nav-link" data-scroll-target="#min">Min</a></li>
  <li><a href="#max" id="toc-max" class="nav-link" data-scroll-target="#max">Max</a></li>
  <li><a href="#alert" id="toc-alert" class="nav-link" data-scroll-target="#alert">Alert</a></li>
  <li><a href="#message" id="toc-message" class="nav-link" data-scroll-target="#message">Message</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  </ul></li>
  <li><a href="#conditional-formatting" id="toc-conditional-formatting" class="nav-link" data-scroll-target="#conditional-formatting">Conditional Formatting</a>
  <ul class="collapse">
  <li><a href="#formatting-condition" id="toc-formatting-condition" class="nav-link" data-scroll-target="#formatting-condition">Formatting condition</a></li>
  <li><a href="#formatting-values" id="toc-formatting-values" class="nav-link" data-scroll-target="#formatting-values">Formatting values</a></li>
  <li><a href="#lock-cells" id="toc-lock-cells" class="nav-link" data-scroll-target="#lock-cells">Lock cells</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../reference/analyses_sheet.html">Reference</a></li><li class="breadcrumb-item"><a href="../reference/dictionary_sheet.html">Dictionary: define linelist tables and their variables</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Dictionary: define linelist tables and their variables</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The dictionary is stored in an Excel table divided into several sections, which define the different sheets that will be part of the Excel linelist produced.</p>
<p><strong>Each line corresponds to a variable</strong> and includes most the characteristics of that variable.</p>
<p>The dictionary is divided into the following sections:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="header">
<th>Section</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Variable name and labels</td>
<td>Lists the variables to be collected by defining their main characteristics</td>
</tr>
<tr class="even">
<td>Sheets and Sections</td>
<td>Allows you to organise variables by sheets, section and sub-section, and define the table orientation</td>
</tr>
<tr class="odd">
<td>Properties</td>
<td>Allows you to assign different properties to variables, in particular defining dropdown menus, formulas or format.</td>
</tr>
<tr class="even">
<td>Data exports</td>
<td>Selects and order the variables to be exported</td>
</tr>
<tr class="odd">
<td>Data validation</td>
<td>Allows you to define accepted MIN and MAX values, and the corresponding alert or error when an input is outside the defined limits.</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>When compiling the setup, make sure that all the columns from this sheet are unhidden.</p>
</div>
</div>
<section id="variable-names-and-labels" class="level2">
<h2 class="anchored" data-anchor-id="variable-names-and-labels">Variable names and labels</h2>
<p>This first part lists all the variables you want to have in the final linelist.</p>
<p><img src="../images/im-003-variable-names-and-labels.png" class="img-fluid"></p>
<section id="variable-name" class="level3">
<h3 class="anchored" data-anchor-id="variable-name">Variable Name</h3>
<p><img src="../images/im-004-variable-names-and-labels.png" class="img-fluid"></p>
<p>This is a free text field used to identify the variable. This name can be used to refer to this variable in formulas or in the <em>Analyses</em> sheet.</p>
<p>After you generate the <strong>linelist file</strong>, the variable name info will be found in the formula bar in the grey cells from the eigth row of the linelist sheet, or in the cell name zone for cells of the <em>Info</em> sheet.</p>
<p>Variable names rules:<br>
- Names must be unique in the <strong>setup file</strong>, even if the variables are on different sheets. If two or more variables were to have the same name, the second occurrence will automatically be suffixed with the value “1”; if there is a third, it will be suffixed with the value “2”, and so on.<br>
- Names must be <strong>at least 4 characters long</strong> to be valid.<br>
- Names should not contain special characters (except for “<em>_</em>”).<br>
- Names will be automatically converted to lowercase during compilation.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>As a general advice, try to create short but explicit names.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>To ensure that variable names are unique, you can add the name of the sheet in which the variable will appear as a prefix, or use numbers.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We recommend that you do not leave any blanks in the variable name. Instead, replace them with “<em>_</em>”.</p>
</div>
</div>
</section>
<section id="main-label" class="level3">
<h3 class="anchored" data-anchor-id="main-label">Main Label</h3>
<p><img src="../images/im-005-main-label.png" class="img-fluid"></p>
<p>This is a free text field that defines the variable label. Labels can be more descriptive and longer than names, but we recommend to keep it moderately short for legibility reasons. The main label appears in black and bold in the <strong>linelist file</strong>.</p>
<p>It cannot be modified by the end user (with one exception, see the “Editable section” below).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>To add more details, you can use the following fields: “Sub Label” and “Note” (see below).</p>
</div>
</div>
</section>
<section id="dev-comment" class="level3">
<h3 class="anchored" data-anchor-id="dev-comment">Dev Comment</h3>
<p><img src="../images/im-006-dev-comment.png" class="img-fluid"></p>
<p>This free text column is for the sole benefit of the <strong>setup file</strong> creator (in all probability, you), to add purely technical or practical information. It is not read by the designer and does not affect the generated file.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>One of the author of this wiki uses these tags:</p>
<ul>
<li><p><strong>Format</strong>: calculated columns created solely for applying conditional formatting (see section on “Conditional formatting” below). These columns are very specific, and pure format. Tagging them helps to quickly make sure that they are never exported</p></li>
<li><p><strong>MoH</strong>: columns created when a general setup is adapted to a specific country, by adding exports to a specific MoH format. Usually, we need to create some calculated columns that match the MoH export (recoding levels, or perhaps merging information of several variables…). I like to keep track of which columns are from the general setup and which are specific adaptations.</p></li>
<li><p><strong>WHO/Epinetwork</strong>: sometimes I want to keep the information that a column is here because it comes from the Epinetwork or the WHO CRF, and should probably not be modified.</p></li>
<li><p><strong>Boilerplate</strong>: calculated columns that are needed for graphs, or because the information is important (such as epiweeks). These columns are often hidden, but not necessarily.</p></li>
</ul>
</div>
</div>
<p>Feel free to use this column in a way that helps you work!</p>
</section>
<section id="editable-label" class="level3">
<h3 class="anchored" data-anchor-id="editable-label">Editable Label</h3>
<p><img src="../images/im-007-editable-label.png" class="img-fluid"></p>
<p>This is a <em>yes/no</em> column. If the value is “<em>yes</em>”, the label of the variable in the linelist can be modified by the user. If the value is “<em>no</em>” or if the field remains empty, the variable label in the linelist will be protected.</p>
</section>
<section id="sub-label" class="level3">
<h3 class="anchored" data-anchor-id="sub-label">Sub Label</h3>
<p><img src="../images/im-008-sub-label.png" class="img-fluid"></p>
<p>This is a free text field used to add a brief description under the variable label, such as the format in which a date is expected, a unit, or any other information to help with filling the variable in.</p>
<p>In the linelist, the sub-label appears just below the main label, in blue and slightly smaller font. It cannot be modified by the end user.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The sublabels “<em>Calculated</em>” and “<em>Custom label</em>” are added automatically, no need to add them manually.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Common sublabels include the following:</p>
<ul>
<li>Yes / No</li>
<li>Yes / No / Unk.</li>
<li>Free text</li>
<li>The format of your date (ex: DD/MM/YYYY)</li>
</ul>
</div>
</div>
</section>
<section id="note" class="level3">
<h3 class="anchored" data-anchor-id="note">Note</h3>
<p><img src="../images/im-009-note.png" class="img-fluid"></p>
<p>This is a free text field which content is added to the linelist as a <em>comment</em> on the corresponding cell. The comment in the linelist can be read by hovering the cursor over the cell. It cannot be modified by the end user.</p>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>Definition in the <strong>setup file</strong>:</p>
<p><img src="../images/im-010-example.png" class="img-fluid"></p>
<p>Display in the <strong>linelistfile</strong>:</p>
<p><img src="../images/im-011-example.png" class="img-fluid"></p>
</section>
</section>
<section id="sheets-and-sections" class="level2">
<h2 class="anchored" data-anchor-id="sheets-and-sections">Sheets and sections</h2>
<p><img src="../images/im-012-sheets-and-sections.png" class="img-fluid"></p>
<p>This section of the dictionary organises variables within <strong>sheets and tables</strong>, and thus creates part of the structure of the linelist.</p>
<p>As a general rule, there is one table per data entry sheet created, but the structure of the table (<em>i.e</em>. the organisation of the variables) can vary.</p>
<section id="sheet-name" class="level3">
<h3 class="anchored" data-anchor-id="sheet-name">Sheet Name</h3>
<p><img src="../images/im-013-shhet-name.png" class="img-fluid"></p>
<p>This is a free text field that contains the <em>name of the sheet</em> in which the variable will appear.</p>
<p>In general, your linelists will contain at least a data entry sheet, and a metadata/general information data sheet.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>More sheets can be created, either automatically (such as the “Instruction” sheet), or by defining analyses in other parts of the <strong>setup file</strong>.</p>
</div>
</div>
</section>
<section id="sheet-types" class="level3">
<h3 class="anchored" data-anchor-id="sheet-types">Sheet Type</h3>
<p><img src="../images/im-014-sheet-type.png" class="img-fluid"></p>
<p>This is a drop-down menu field used to define the <em>type of table</em> contained in the sheet. There are 2 options:</p>
<ul>
<li><p><strong>vlist1D</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>: corresponds to a table built vertically, so the variables <em>labels</em> appear in columns, and <strong>only one entry is expected for each variable</strong>. This type of sheet is used to collect general information about the facilities or data collection.</p></li>
<li><p><strong>hlist2D</strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>: corresponds to a horizontally constructed table, so the variables labels appear in a row, and <strong>several entries are possible for each variable</strong>. This type of sheet is used to collect patient data.</p></li>
</ul>
<p><img src="../images/im-015-sheet-type.png" class="img-fluid"></p>
</section>
<section id="main-section" class="level3">
<h3 class="anchored" data-anchor-id="main-section">Main Section</h3>
<p><img src="../images/im-016-main-section.png" class="img-fluid"></p>
<p>This is a free text field used to define the <em>name</em> of the main section in which the variable is located. This makes it possible to organise variables by theme to make data entry and navigation easier.</p>
<p>In the linelist file, the main sections appear in a darker colour in rows or columns, depending on the type of table (dark blue in <strong>?@sec-sheet-sections-example</strong>). They cannot be modified by the end user.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>To make the dictionary easier to read, we recommend that you group (write one below another) the variables of a same sheet and a same section.</p>
</div>
</div>
</section>
<section id="sub-section" class="level3">
<h3 class="anchored" data-anchor-id="sub-section">Sub Section</h3>
<p><img src="../images/im-017-sub-section.png" class="img-fluid"></p>
<p>This is a free text field that allows you to further refine the organisation of variables in the table by creating a second level of grouping.</p>
<p>In the linelist file, the sub-sections appear in a lighter colour in the row or column, depending on the type of table (light blue in <strong>?@sec-sheet-sections-example</strong>). They cannot be modified by the end user.</p>
</section>
<section id="sheet-sections-example" class="level3">
<h3 class="anchored" data-anchor-id="sheet-sections-example">Example</h3>
<section id="vlist1d" class="level4">
<h4 class="anchored" data-anchor-id="vlist1d">vlist1D</h4>
<p>Definition in the <strong>setup file</strong>:</p>
<p><img src="../images/im-018-vlist1d.png" class="img-fluid"></p>
<p>Display in the <strong>linelist file</strong>:</p>
<p><img src="../images/im-019-vlist1d.png" class="img-fluid"></p>
</section>
<section id="hlist2d" class="level4">
<h4 class="anchored" data-anchor-id="hlist2d">hlist2D</h4>
<p>Definition in the <strong>setup file</strong>:</p>
<p><img src="../images/im-020-hlist2d.png" class="img-fluid"></p>
<p>Display in the <strong>linelist file</strong>:</p>
<p><img src="../images/im-021-hlist2d.png" class="img-fluid"></p>
</section>
</section>
</section>
<section id="properties" class="level2">
<h2 class="anchored" data-anchor-id="properties">Properties</h2>
<p>The properties section is as follows:</p>
<p><img src="../images/im-023-status.png" class="img-fluid"></p>
<section id="status" class="level3">
<h3 class="anchored" data-anchor-id="status">Status</h3>
<p>This is a drop-down field that contains four options for defining the <strong>visibility</strong> of the variable:</p>
<ul>
<li><p><strong>“mandatory”</strong>: variable displayed by default, it cannot be hidden in the linelist</p></li>
<li><p><strong>“optional, visible”</strong>: variable displayed by default, it can be displayed or hidden by the linelist user</p></li>
<li><p><strong>“optional, hidden”</strong>: variable hidden by default, it can be displayed or hidden by the linelist user</p></li>
<li><p><strong>“hidden”</strong>: variable hidden by default, it cannot be displayed in the linelist</p></li>
</ul>
<p>Variables can be shown or hidden using the <em>Show/Hide</em> button in the <strong>linelist file</strong>.</p>
<section id="example-1" class="level4">
<h4 class="anchored" data-anchor-id="example-1"><strong>Example</strong></h4>
<p>Definition in the <strong>setup file</strong>:</p>
<p><img src="../images/im-024-example.png" class="img-fluid"></p>
<p>Display in the <strong>linelist file</strong>:</p>
<p><img src="../images/im-025-example.png" class="img-fluid"></p>
<p><img src="../images/im-026-example.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>“Mandatory” variables in the <strong>setup file</strong> appear as “Mandatory” in the “Show/Hide” pop up, and cannot be hidden.</p>
<p><strong>1</strong></p>
<p>The “optional, hidden” variables in the <strong>setup file</strong> appear as “Hidden” (by default). However, the user can change the status by choosing “Show”, in which case the column will become visible. <img src="../images/im-027-example.png" class="img-fluid"></p>
<p><strong>2</strong> <img src="../images/im-028-example.png" class="img-fluid"></p>
<p><strong>3</strong></p>
<p>The “Notification year” variable does not appear in the list of variables because it is in “hidden” status in the <strong>setup file</strong>.</p>
<p>The “optional, visible” variables in the <strong>setup file</strong> appear as “Displayed” (by default). However, you can change the status by choosing “Hide”, in which case the column will no longer be visible.</p>
<p><strong>4</strong> <img src="../images/im-029-example.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="register-book" class="level3">
<h3 class="anchored" data-anchor-id="register-book">Register Book</h3>
<p><img src="../images/im-030-register-book.png" class="img-fluid"></p>
<p>This is a <em>yes/no</em> drop-down menu field used to predefine the variables to be included in the register to be printed. This is not mandatory and can be managed later, directly in the <strong>linelist file</strong>.</p>
</section>
<section id="personal-identifier" class="level3">
<h3 class="anchored" data-anchor-id="personal-identifier">Personal Identifier</h3>
<p><img src="../images/im-031-personal-identifier.png" class="img-fluid"></p>
<p>This is a <em>yes/no</em> drop-down menu field that indicates that the variable contains personal data (such as names, phone numbers etc.).</p>
<p>This column has to uses: - it allows the setup developer to quickly identify variables containing personal data in its dictionary<br>
- it is used to remove variables automatically from the exports if such a behaviour is needed (see the <em>Exports</em> sheet).</p>
</section>
<section id="thinking-about-variables" class="level3">
<h3 class="anchored" data-anchor-id="thinking-about-variables">Thinking about variables</h3>
<p>There are many ways of thinking about variables and of classifying them.</p>
<p>In general we can distinguished between <em>input</em> variables, where the user enters raw data, and <em>calculated</em> (or derived) variables, which require no input. Both of them can be created in OutbreakTools.</p>
<p>Independently of this distinction, a variety of <strong>variables types</strong> can exist, containing numbers or text in various forms. In Excel, we will often use the types <em>integer</em>, <em>decimals</em>, <em>dates</em> and <em>text</em>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. See the section on <strong>?@sec-var-type</strong> for more information.</p>
<p>For input variables, you could think of two ways of entering data: a “free” approach, where user can enter the value of their choice, and a controlled (constrained) approach, where the values the user can enter are limited. In Excel, this is generally implemented through <em>dropdown menus</em> from which the data encoder selects a value. In OutbreakTools, there have several ways of building dropdown menus, depending on whether you know the categories in advance or not. This is what we call “variable control”. Learn more about it in the <strong>?@sec-var-control</strong>.</p>
<p>Finally, many software allow the user to set the way the data is displayed, which we here call <strong>format</strong>. For example:<br>
- The date first of January of 2023 can be displayed as “01/01/2024”, or “1/1/24” or 1-Jan-24” etc.<br>
- The number “1” could be displayed as “1” simply, or “001”<br>
- The number 0.01 could be displayed with different levels of rounding, or even as “10%” if the column contains proportions that can be displayed as percentages.<br>
Learn more about format in <strong>?@sec-var-format</strong></p>
</section>
<section id="var-type" class="level3">
<h3 class="anchored" data-anchor-id="var-type">Variable Type</h3>
<p><img src="../images/im-032-variable-type.png" class="img-fluid"></p>
<p>This column proposes a drop-down menu field containing four options for defining the type [^which is sometimes called <em>class</em> in some softwares] of each variable:</p>
<ul>
<li><p><strong>Text</strong>: creates a column of text [^also called character string in some softwares]. The entry of the text may be free or constrained by a dropdown menu, see the <strong>?@sec-var-control</strong> section below.</p></li>
<li><p><strong>Date</strong>: creates a date column, whose exact format is defined in the next column, <strong>?@sec-var-format</strong>. The default format is <em>jj-mmm-aaaa</em>.</p></li>
<li><p><strong>Integer</strong>: creates an integer column</p></li>
<li><p><strong>Decimal</strong>: creates a column with decimal numbers. The number of digits after the decimal point is defined in the following <strong>?@sec-var-format</strong> column.</p></li>
</ul>
<p><img src="../images/im-127-var-types.png" class="img-fluid"></p>
</section>
<section id="var-format" class="level3">
<h3 class="anchored" data-anchor-id="var-format">Variable Format</h3>
<p><img src="../images/im-033-variable-format.png" class="img-fluid"></p>
<p>This field is used to specify the <strong>format</strong> of the variable (which depends on its <strong>type</strong>).</p>
<p>There is a predefined drop-down list with common options, but you can enter any format by hand, as long as it is written in Excel syntax.</p>
<p><img src="../images/im-034-variable-format.png" class="img-fluid"></p>
<p>Example: for an integer to appear with at least 2 characters, enter the format: # #00</p>
<p>Note that the default data format is <em>jj-mmm-aaaa</em>.</p>
</section>
<section id="var-control" class="level3">
<h3 class="anchored" data-anchor-id="var-control">Control</h3>
<p><img src="../images/im-035-control.png" class="img-fluid"></p>
<p>This is a dropdown field containing nine options for defining variables that are not simple free entry variables:</p>
<ul>
<li>choice_manual</li>
<li>choice_custom</li>
<li>choice_multiple</li>
<li>list_auto</li>
<li>geo</li>
<li>hf</li>
<li>formula</li>
<li>case_when</li>
<li>choice_formula</li>
</ul>
<p>These options can be broadly classified in three sorts of variables to be created:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 35%">
<col style="width: 38%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Sort of variable</th>
<th>Controls</th>
<th>Data entry in the linelist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Categorical</td>
<td>choice_manual, choice_custom, choice_multiple, list_auto</td>
<td>Dropdown menu</td>
</tr>
<tr class="even">
<td>Geo-related columns (a special case of categorical)</td>
<td>geo, hf</td>
<td>GeoHelper or dropdown menu</td>
</tr>
<tr class="odd">
<td>Calculated</td>
<td>formula, choice_formula, case_when</td>
<td>No user input needed in these columns</td>
</tr>
</tbody>
</table>
<p><img src="../images/im-128-var-control.png" class="img-fluid"></p>
<section id="dropdown-menu-variables" class="level4">
<h4 class="anchored" data-anchor-id="dropdown-menu-variables">Dropdown menu variables</h4>
<p>This table summarises the different options:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 18%">
<col style="width: 25%">
<col style="width: 45%">
</colgroup>
<tbody>
<tr class="odd">
<td rowspan="2"><h1 id="control">Control</h1>
<p>choice_manual</p></td>
<td rowspan="2"><h1 id="how-to-populate-the-dropdown-menu">How to populate the dropdown menu?</h1>
<p>Predefined values</p></td>
<td rowspan="2"><h1 id="where-are-values-defined">Where are values defined?</h1>
<p><strong>Setup file</strong>, in the “<em>Choice</em>” sheet</p></td>
<td rowspan="2">Data entry in the linelist | =====================================================================================+ <strong>One value</strong> selected from a dropdown menu |</td>
</tr>
<tr class="even">
</tr>
<tr class="odd">
<td>choice_multiple</td>
<td>Predefined values</td>
<td><strong>Setup file</strong>, in the “<em>Choice</em>” sheet</td>
<td><strong>Several values</strong> selected from a dropdown menu |</td>
</tr>
<tr class="even">
<td>choice_custom</td>
<td>User-defined values (but see details)</td>
<td><strong>Linelist file</strong>, in the “<em>Custom dropdown</em>” sheet</td>
<td><strong>One value</strong> selected from a dropdown menu |</td>
</tr>
<tr class="odd">
<td>list_auto</td>
<td colspan="3">User-defined values but from another data column | <strong>Linelist file</strong>, in another column | <strong>One value</strong>, selected from a dropdown populated by the values of another variable</td>
</tr>
</tbody>
</table>
<section id="choice_manual" class="level5">
<h5 class="anchored" data-anchor-id="choice_manual">Choice_manual</h5>
<p>This control creates a categorical variable with a <strong>static dropdown menu</strong> in the linelist, from which <strong>one value</strong> can be selected. The authorised values from the dropdown menu are <strong>defined in advance in the setup</strong> and cannot be modified by the users of the linelist (hence the “static”).</p>
<p>In the <strong>setup file</strong>, we define these values in a list stored in the <em>“Choices”</em> sheet, and fill the name of that list in the column “Control details” column (see <strong>?@sec-var-control-details</strong> section).</p>
</section>
<section id="choice_multiple" class="level5">
<h5 class="anchored" data-anchor-id="choice_multiple">Choice_multiple</h5>
<p>This control is similar to the choice manual, in that it creates a <strong>static drop-down menu</strong> in the linelist from <strong>predefined values</strong> entered in the setup.</p>
<p>The difference is that in the created <strong>linelist file</strong>, the user can use the dropdown menu several times to select <strong>multiple values</strong>. These values will be concatenated and stored as a chain of character. By default, the separator is a coma (“,”), but you can modify this in the control column. For example, entering <em>choice_multiple(“_”)</em> would use the character “_” to separate values instead of “,”.</p>
<p><strong>Example</strong>: if the user select “Azythromicin”, then “Ampicilin” from a dropdown menu, the value “Azythromicin, Ampicilin” will be stored in the cell.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>A choice_multiple column cannot be used in the <em>Analyses</em> sheets as the designer cannot predict the number of combinations the user will create, and thus cannot create tables with appropriate size.</p>
</div>
</div>
</section>
<section id="choice_custom" class="level5">
<h5 class="anchored" data-anchor-id="choice_custom">Choice_custom</h5>
<p>This control creates a <strong>dynamic dropdown menu</strong> in the linelist, but contrary to the previous controls, the values are not (necessarily) predefined in the setup, but instead <strong>defined by the user</strong>. This control is useful for variables where one would like to enforce standardization of values, but the values to encode are not known in advance.</p>
<p><strong>Example</strong>: you wish to create a column containing the name of facilities patients can be transferred to. The names of these facilities is site dependent, thus unknown in advance.</p>
<p>Using the choice_custom control will create a table in the “<em>Custom dropdown</em>” sheet in the linelist where the user can fill-in values to populate the <strong>dynamic, customised drop-down menu</strong>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>While by default the dropdown menu created is empty, it is possible to prefill it by filling the “Control Details” column with a list of choices, like for the other types of dropdowns menus (see <strong>?@sec-var-control-details</strong> section). The table in the “<em>Custom dropdown</em>” sheet of the linelist will still created and future users will be able to modify/grow it.</p>
</div>
</div>
</section>
<section id="list-auto" class="level5">
<h5 class="anchored" data-anchor-id="list-auto">List_auto</h5>
<p>This control also creates a <strong>dynamic dropdown menu</strong>, but the values come from the data entered in another column.</p>
<p><strong>Example</strong>: a linelist contains two data-entry sheets: - the first data entry sheet contains patient data<br>
- a second data entry sheet contains more variables for a subset of re-admitted patients.</p>
<p>The list_auto control allows to create a column on the second sheet with a drop-down menu populated dynamically with the patient IDs from the first sheet.</p>
<p>In the setup, the <strong>variable</strong> used to populate the drop-down menu is defined in the “Control Details” column of the <em>Dictionary</em> sheet (see <strong>?@sec-var-control-details</strong> section).</p>
</section>
</section>
<section id="special-case-of-amdinistrative-levels-and-health-facilities" class="level4">
<h4 class="anchored" data-anchor-id="special-case-of-amdinistrative-levels-and-health-facilities">Special case of amdinistrative levels and health facilities</h4>
<p>Two controls allow us to enter geographic information, or information about health facilities. While the created variables will technically contain dropdown menus, they are treated as a special type of variables in OubtbreakTools linelists, with dedicated tools and analyses.</p>
<p>OutbreakTool linelists all have a button to import a geobase, a standardised file containing lists of administrative levels to describe places. Once the geobase successfully imported, the values from its lists will populate specific dropdown menus (see the linelist documentation on how to import a geobase).</p>
<section id="geo" class="level5">
<h5 class="anchored" data-anchor-id="geo">Geo</h5>
<p>The “geo” control indicates that geographic data is expected. In the linelist, this results in the creation of <strong>4 columns</strong>, one for each administrative level, which will be populated by values imported from a geobase. The user can enter data by using the <em>GeoHelper</em> button in the linelist or by selecting values from the cascading dropdown menus in the linelist.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The “geo” control does not need additional information to be filled in the “Control Details” column.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the linelist, the variable labels appear in an <strong>orange cell</strong>, which means that the “GeoHelper” button can be used to fill in the corresponding cells.</p>
</div>
</div>
<p><strong>Example:</strong></p>
<p>Definition in the <strong>setup file</strong>:</p>
<p><img src="../images/im-037-example.png" class="img-fluid"></p>
<p>Display in the <strong>linelist file</strong>:</p>
<p><img src="../images/im-038-example.png" class="img-fluid"></p>
</section>
<section id="hf" class="level5">
<h5 class="anchored" data-anchor-id="hf">HF</h5>
<p>The “hf” control means that the user will enter en health facility. By identifying hf data in this way, you can use the <em>GeoHelper</em> button in the linelist to fill in the column.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Similarly to the “geo” control, the “hf” control does not need additional information to be filled in the “Control Details” column.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The variable label appears in an orange cell, which means that the <em>GeoHelper</em> button can be used to fill in the corresponding cells.</p>
</div>
</div>
<p><strong>Example:</strong></p>
<p>Definition in the <strong>setup file</strong>:</p>
<p><img src="../images/im-039-example-hf.png" class="img-fluid"></p>
<p>Display in the linelist :</p>
<p><img src="../images/im-040-example-hf.png" class="img-fluid"></p>
</section>
</section>
<section id="calculated-variables" class="level4">
<h4 class="anchored" data-anchor-id="calculated-variables">Calculated variables</h4>
<p>Three controls allow the creation of calculated columns. In general, the user can define a column by providing an Excel <em>formula</em> [^<em>i.e.</em> a combination of Excel <em>functions</em>], but the setup file also provides two custom functions, CASE_WHEN and CHOICE_FORMULA to simplify formula syntax.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 12%">
<col style="width: 24%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Control</th>
<th>Functions</th>
<th>Use</th>
<th>Default value</th>
<th style="text-align: center;">Can be used in analyses tables</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>formula</td>
<td>Any combination of Excel functions (in English)</td>
<td>Anything</td>
<td></td>
<td style="text-align: center;"><p>Continuous variables: yes</p>
<p>Categorical variables: no</p></td>
</tr>
<tr class="even">
<td>case_when</td>
<td><strong>CASE_WHEN</strong> (Excel functions optional)</td>
<td>Replaces nested IF</td>
<td>Empty cell; user can modify it</td>
<td style="text-align: center;">no</td>
</tr>
<tr class="odd">
<td>choice_formula</td>
<td><strong>CHOICE_FORMULA</strong> (Excel functions optional)</td>
<td>Replaces nested IF</td>
<td>Empty character; user cannot modify it</td>
<td style="text-align: center;">yes</td>
</tr>
</tbody>
</table>
<section id="formula" class="level5">
<h5 class="anchored" data-anchor-id="formula">Formula</h5>
<p>When using the “formula” control, the value displayed is calculated according to a formula defined in the <a href="#sec-var-control-details">Control details column</a> of the dictionary.</p>
</section>
<section id="case_when" class="level5">
<h5 class="anchored" data-anchor-id="case_when">Case_when</h5>
<p>Variables of control “case_when” use a specifically developed function, CASE_WHEN, which replaces a succession of nested IF. While you could write the formula with nested IF, CASE_WHEN is easier to read, thus simpler to use.</p>
<p><strong>Case usage</strong>: you want to recode a variable, but you do not know which values will be generated. For example, the raw data contains a columns for the age value and a column for the age unit. You use CASE_WHEN to create a column “age_years”. The values which will be present in the column can take many decimal value in the range of reasonable ages.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Categorical variable created with this control <strong>cannot be used in univariate or bivariate tables</strong> in analyses sheets, because we cannot know in advance how many modalities the variable will take, and thus the <strong>designer</strong> cannot construct the tables.</p>
<p>On the other hand, numeric variables created with this control [^(such as age in years)] can be summarised in the analyses. Indeed, taking the average or the median of a numeric variable variable will always output one value, so the designer knows what to expect.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the variable is not identified with a “case_when” control, and you still use the function in the “formula” column, Excel will not be able to return the desired result because the function is not native.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you are using a recent version of Excel, you may know the functions IFS or SWITCH. Outbreak Tools does not rely on them as they are not retro compatible with some older versions of Excel. Use a CASE_WHEN or CHOICE_FORMULA instead.</p>
</div>
</div>
<p>Read more about writing the formula in the <a href="#sec-var-control-details">Control details column</a> of the dictionary.</p>
</section>
<section id="choice_formula" class="level5">
<h5 class="anchored" data-anchor-id="choice_formula">Choice_formula</h5>
<p>This control indicates the use of the CHOICE_FORMULA function, another custom function to create a calculated column. This function is a special case of the CASE_WHEN formula with more constrains on it. In this case, the values that the calculated variable can take are known in advance and predefined in the “<em>Choices</em>” sheet.</p>
<p>Columns generated with this control can be used in univariate or bivariate tables, as the number of possible categories is known in advance.</p>
<p>Read more about writing the formula in the <a href="#sec-var-control-details">Control details column</a> of the dictionary.</p>
</section>
</section>
</section>
<section id="var-control-details" class="level3">
<h3 class="anchored" data-anchor-id="var-control-details">Control details</h3>
<p>This is a free text field, which accepts three types of values: - the name of a <em>list</em> (defined in the <em>Choices</em> sheet), - the name or a <em>variable</em> (defined in the <em>Dictionary</em> sheet) - a <em>formula</em>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 23%">
<col style="width: 59%">
<col style="width: 4%">
</colgroup>
<tbody>
<tr class="odd">
<td rowspan="2"><h1 id="control-type">Control type</h1>
<p>Static dropdown menu</p></td>
<td rowspan="2"><h1 id="control-column">Control column</h1>
<p>choice_manual, choice_custom, choice_multiple</p></td>
<td colspan="2" rowspan="2">Value expected in the “Control details” column | ========================================================================================================================+ The name of a <em>list</em> that contains the authorised values, defined in the <em>Choice</em> sheet (“List Name” column) |</td>
</tr>
<tr class="even">
</tr>
<tr class="odd">
<td>Dynamic dropdown menu</td>
<td>list_auto</td>
<td colspan="2">The name of an existing <em>variable</em></td>
</tr>
<tr class="even">
<td>Calculated</td>
<td>formula, choice_formula, case_when</td>
<td>An Excel formula (that can contain one or more functions, including the custom functions CASE_WHEN and CHOICE_FORMULA)</td>
<td></td>
</tr>
</tbody>
</table>
<section id="defining-dropdown-menu-categories" class="level4">
<h4 class="anchored" data-anchor-id="defining-dropdown-menu-categories">Defining dropdown menu categories</h4>
<p>When the controls “choice_manual”, “choice_multiple” and “choice_custom” (optional) are selected in the <a href="#sec-var-control">“Control” column</a>, you need to define the values the dropdown menu will contain. These values are entered on another sheet, the <em>Choices</em> sheet. Categories for a same variable are bundled into <em>lists</em>. The name of the list is entered in the “Control details” column.</p>
<p><img src="../images/im-041-choices.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For more information on the definition of drop-down menus, see the <em>Choices</em> sheet page.</p>
</div>
</div>
<p>In the case of “list auto” variables, you only need to provide the name of another variable in the “Control details” column. In the linelist, the values present in the referred variables will be automatically used to populate the dropdown menu.</p>
</section>
<section id="formulas" class="level4">
<h4 class="anchored" data-anchor-id="formulas">Formulas</h4>
<p>If you have selected “formula”, “choice_formula” or “case_when” in the <a href="#sec-var-control">“Control” column</a>, you need to provide the formula to be applied in this column.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The information given in the <a href="#sec-formula-control">Formula control</a> section below are also valid for “choice_formula” and “case_when” controls as these, while based on custom functions, are still formulas.</p>
</div>
</div>
<section id="formula-control" class="level5">
<h5 class="anchored" data-anchor-id="formula-control">Formula control</h5>
<p>The formula is written <strong>in English</strong>, <strong>without an “=” sign</strong>. The formulas are automatically translated into the Excel language defined on the computer used to generate the linelist.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>If your Excel is not usually in English, pay special attention to the following:</p>
<ul>
<li><p>Use the English function names, such as “MEAN” instead of “MOYENNE”, or “IF” instead of “SI”.</p></li>
<li><p>Function arguments are separated by <strong>“,”</strong> in English. Beware of lingering “;” if you are used to Excel in French!</p></li>
<li><p>Similarly, English Excel uses <strong>“.”</strong> for decimals, not “,” like in French.</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>In Excel, you can use ALT+ENTRY to insert a carriage return and go to the next line. This does not affect the execution of your formulas, but greatly increases the readability. The same goes for inserting spaces around operators. Contrast these two formulas:</p>
</div>
</div>
<p><img src="../images/im-129-formula-style.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>When writing a formula, make sure that it returns an empty value for rows without an ID, as all the rows with non-null values in it will be counted in the <em>Analyses</em> sheets. If your graphs show a lot of “Missing” values that do not reflect how well a column is filled, check that a calculated column is not responsible for it.</p>
</div>
</div>
</section>
<section id="case_when-control" class="level5">
<h5 class="anchored" data-anchor-id="case_when-control">Case_when control</h5>
<p>Use the CASE_WHEN function to replace nested IF (therefore limiting the risk of error when writing the formula), in this form:</p>
<blockquote class="blockquote">
<p>CASE_WHEN( condition1, value1, condition2, value2, condition3, value3, …, …, DEFAULT_VALUE)</p>
</blockquote>
<p>You need at least one pair of conditions but the function shines when there are many pairs. As in the nested IF or in the IFS functions, <em>the conditional statement are tested in the order they are written</em>. By default, any case that is not covered by the previous conditions will return an empty cell, unless you provide a default value (the <em>else</em>).</p>
<p><strong>Example</strong></p>
<p>You could write a formula with nested IF to calculate an age_years column:</p>
<blockquote class="blockquote">
<p>IF(age_unit = “months”, age_value / 12, IF(age_unit = “days”, age_value / 365, IF(age_unit = “years”, age_value, IF(ISBLANK(age_unit), ““))))</p>
</blockquote>
<p>Or write the equivalent with CASE_WHEN:</p>
<blockquote class="blockquote">
<p>CASE_WHEN( age_unit = “months”, age_value / 12, age_unit = “days”, age_value / 365, age_unit = “years”, age_value)</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The information about the more generalist “formula” control are also valid here.</p>
</div>
</div>
</section>
<section id="choice_formula-control" class="level5">
<h5 class="anchored" data-anchor-id="choice_formula-control">Choice_formula control</h5>
<p>The CHOICE_FORMULA function is a subcase of CASE_WHEN for when we want to encode a few <strong>known modalities</strong>.</p>
<p>The pseudo-code is very similar to the CASE_WHEN function:</p>
<blockquote class="blockquote">
<p>CHOICE_FORMULA(list_values_choices, condition1, value1, condition2, value2, condition3, value3, …, … )</p>
</blockquote>
<p>But here, the value1, value2, value3 etc. are pre-defined in the list “list_values_choices” in the <em>“Choices”</em> sheet, as if these values were for a dropdown menu <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<p>Since we know exactly which modalities this variable can take, we can use it as a categorical variable in the <em>Analyses</em> sheet, to build a uni or a bivariate table.</p>
<p><strong>Example:</strong></p>
<blockquote class="blockquote">
<p>CHOICE_FORMULA(list_age_group, age_years &lt; 5, “0 – 4 years”, age_years &lt; 10, “5 – 9 years, age_years &lt; 15,”10 – 14 years, age_years &lt; 20, “15 – 19 years, AND(age_years &gt;= 20, age_years &lt; 120),”20+ years” )</p>
</blockquote>
<p>Here, “list_age_group” corresponds to the list where the potential values to be returned are predefined; “age_years” is an existing variable that contains the age in years. The values between inverted commas (“0 – 5 years”) correspond to the possible results, predefined in “list_age_group”.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The information about the more generalist “formula” control are also valid here.</p>
</div>
</div>
</section>
</section>
</section>
<section id="unique" class="level3">
<h3 class="anchored" data-anchor-id="unique">Unique</h3>
<p>This is a <em>yes/no</em> drop-down menu field. It has no direct impact on the linelist, but the information can be used in the data cleaning phase.</p>
</section>
</section>
<section id="data-exports" class="level2">
<h2 class="anchored" data-anchor-id="data-exports">Data exports</h2>
<p><img src="../images/im-042-data-exports.png" class="img-fluid"></p>
<p>This section lets you <strong>choose the variables you want to have in each export</strong>. The rest is defined in the <em>“Exports”</em> sheet (see the ‘Data exports’ page).</p>
<p>You can define the order in which variables are displayed in exports. To do this, simply number them in the desired order.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variables with <strong>any values</strong> entered in the Export columns will be exported. If you want to <strong>not</strong> export a variable, you need to keep the cells <strong>empty</strong>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If two variables have the same number in the same export columns, they will be exported in the order they are defined in the setup (from top to bottom).</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you wish to create an anonymous export, i.e.&nbsp;one containing no personal identifier, you can filter the “personal identifier” column to ‘yes’ and check that the column corresponding to the anonymous export is empty.</p>
</div>
</div>
</section>
<section id="data-validation" class="level2">
<h2 class="anchored" data-anchor-id="data-validation">Data validation</h2>
<p><img src="../images/im-043-data-validation.png" class="img-fluid"></p>
<p>To improve the quality of the data entered, it is possible to alert or block the user if they attempt to enter unvalid data.</p>
<p>For continuous variables, you need to specify the min and or max values (see below), but for dropdown menu variables, go directly to the “Alert” column.</p>
<section id="min" class="level3">
<h3 class="anchored" data-anchor-id="min">Min</h3>
<p>This is a free text field that defines the minimal authorised value in the variable. It can be an integer, a decimal number, the name of a variable or a formula.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>As with the formulas, the “=” sign is <strong>not</strong> placed in front of the limits you define.</p>
</div>
</div>
<p>Examples: - “0” to not allow negative vallues in an age in month or year column<br>
- “date_notification” to not allo the date of exit to be before the arrival in the health facility<br>
- “today() - 2 * 365” to avoid dates older than two years if you know that the linelist is not used to enter retrospective data</p>
</section>
<section id="max" class="level3">
<h3 class="anchored" data-anchor-id="max">Max</h3>
<p>This is a free text field used to define the upper limit of authorised values. It can be an integer, a decimal number, a variable name or a formula.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>As with the formulas, the “=” sign is <strong>not</strong> placed in front of the limits you define.</p>
</div>
</div>
<p>Examples: - “120” to limit the age in year<br>
- “today()” to not allow dates after the day of data entry in the case of most date columns</p>
</section>
<section id="alert" class="level3">
<h3 class="anchored" data-anchor-id="alert">Alert</h3>
<p>This is a drop-down field. There are two possible options:</p>
<ul>
<li>error</li>
<li>warning</li>
</ul>
<p>❌ The “error” message blocks data entry: it is impossible to force the entry of a value other than the authorised one. It is symbolised by a cross in a red circle <a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<p>⚠️ “warning” warns the end user that the data entered is not within the expected values, but if they wish they can still keep this data. It is symbolised by an exclamation mark in an orange triangle.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can add error and warnings to columns with dropdown menus, the messages will appear if the user tries to enter a value not from the dropdown menu.</p>
</div>
</div>
</section>
<section id="message" class="level3">
<h3 class="anchored" data-anchor-id="message">Message</h3>
<p>This is a free text field used to give the end user an indication of why their entry is invalid.</p>
</section>
<section id="examples" class="level3">
<h3 class="anchored" data-anchor-id="examples">Examples</h3>
<section id="a-continuous-variable-patients-age" class="level4">
<h4 class="anchored" data-anchor-id="a-continuous-variable-patients-age">A continuous variable: patient’s age</h4>
<p>Definition in the <strong>setup file</strong>:</p>
<p><img src="../images/im-044-patients-age.png" class="img-fluid"></p>
<p>How it is encoded in the data validation system of the <strong>linelist file</strong>:</p>
<p><img src="../images/im-045-patients-age.png" class="img-fluid"></p>
<p>Warning box appearing when the user attempts to enter invalid data:</p>
<p><img src="../images/im-046-warnings.png" class="img-fluid"></p>
</section>
<section id="a-categorical-variable-age-unit" class="level4">
<h4 class="anchored" data-anchor-id="a-categorical-variable-age-unit">A categorical variable: age unit</h4>
<p>Definition in the <strong>setup file</strong>:</p>
<p><img src="../images/im-047-age-unit.png" class="img-fluid"></p>
<p>Display in the linelist:</p>
<p><img src="../images/im-048-age-unit.png" class="img-fluid"></p>
</section>
<section id="a-date-variable" class="level4">
<h4 class="anchored" data-anchor-id="a-date-variable">A date variable</h4>
<p>Definition in the <strong>setup file</strong>:</p>
<p><img src="../images/im-049-date.png" class="img-fluid"></p>
<p>How it is encoded in the data validation system of the <strong>linelist file</strong>:</p>
<p><img src="../images/im-050-date.png" class="img-fluid"></p>
<p>Warning box appearing when the user attempts to enter invalid data:</p>
<p><img src="../images/im-051-warning.png" class="img-fluid"></p>
</section>
</section>
</section>
<section id="conditional-formatting" class="level2">
<h2 class="anchored" data-anchor-id="conditional-formatting">Conditional Formatting</h2>
<p><img src="../images/im-052-conditional-formatting.png" class="img-fluid"></p>
<p>This section is used to define conditional formatting rules.</p>
<section id="formatting-condition" class="level3">
<h3 class="anchored" data-anchor-id="formatting-condition">Formatting condition</h3>
<p>The “Formatting Condition” column is a free text column where one must provide the <strong>name of a variable to use as a reference</strong>. Rows for which the reference column contains <em>1</em> will be formatted with the formatting defined in the “Formatting Values” column. Row containing <em>0</em> will have no special formatting.</p>
<p>This means that in most cases, you will need to calculate a dummy variable, with a result of 1 or 0, to guide the formatting.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>you can give special names to these calculated columns to easily identify them.</p>
</div>
</div>
</section>
<section id="formatting-values" class="level3">
<h3 class="anchored" data-anchor-id="formatting-values">Formatting values</h3>
<p>This is a free text column, but what matters is not the text entered in it but the formatting applied to it, which is read and applied to the cells in the <strong>linelist file</strong>, if the formatting condition is met.</p>
</section>
<section id="lock-cells" class="level3">
<h3 class="anchored" data-anchor-id="lock-cells">Lock cells</h3>
<p>The ‘Lock Cells’ section is not currently available.</p>
</section>
<section id="example-2" class="level3">
<h3 class="anchored" data-anchor-id="example-2">Example</h3>
<p>Definition in the <strong>setup file</strong>:</p>
<p><img src="../images/im-053-example-lock-cells.png" class="img-fluid"></p>
<p><img src="../images/im-054-example-lock-cells.png" class="img-fluid"></p>
<p>Display in the <strong>linelist file</strong>:</p>
<p><img src="../images/im-055-example-lock-cells.png" class="img-fluid"></p>
<p>Note that the hospitalised_format columns is completely hidden because it is of no interest to the user, just needed internally to know where to apply formatting.</p>


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>vlist = vertical list of labels<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>hlist = horizontal list<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Note that we used the word “type” in its <em>computer science</em> meaning, which differs a bit from the <em>statisctics</em> one<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>you can of course give the list any name that you wish, such as “list_age_group” for example if you were recoding age<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Sometimes the user manage to break through by pasting values though<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/epicentre-msf\.github\.io\/test-obt-doc-website\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../reference/custom_formulas.html" class="pagination-link" aria-label="Custom formulas">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Custom formulas</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../reference/exports_sheet.html" class="pagination-link" aria-label="Define exports">
        <span class="nav-page-text">Define exports</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Developed by <a href="https://epicentre.msf.org/">Epicentre</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>